<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>‚ù§Ô∏è</title>
  <style>
    :root{
      --bg: #f2e2df;
      --text: #2d2a2a;
      --accent: #c62828;
    }
    html,body{height:100%;margin:0;font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;}
    body{background:#000; overflow:hidden;}

    /* ====== FORZAR HORIZONTAL SIEMPRE (sin girar el celular) ====== */
    #stage{
      position:fixed; inset:0;
      background: var(--bg);
      transform-origin: center center;
      /* se ajusta por JS para quedar en horizontal */
    }

    /* pantallas */
    .screen{position:absolute; inset:0; display:none;}
    .show{display:block;}

    /* ====== INTRO NEGRO 4s ====== */
    #screenIntro{
      background:#000;
      color:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .introWrap{
      display:flex;
      gap:28px;
      align-items:center;
      justify-content:center;
      width:90%;
      max-width:1100px;
    }
    .phoneIcon{
      width:110px; height:220px;
      border:6px solid #fff;
      border-radius:28px;
      position:relative;
      transform: rotate(-20deg);
      opacity:.95;
    }
    .phoneIcon::before{
      content:"";
      position:absolute; left:18px; right:18px; top:18px;
      height:10px; border-radius:10px;
      background:#fff;
      opacity:.9;
    }
    .introTxt h1{
      margin:0 0 8px 0;
      font-size:40px;
      letter-spacing:.5px;
      font-weight:800;
      text-transform:uppercase;
    }
    .introTxt p{
      margin:0;
      font-size:20px;
      opacity:.9;
    }

    /* ====== PANTALLA CORAZ√ìN (tap to continue) ====== */
    #screenHeart{
      background: var(--bg);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .heartWrap{
      width:92%;
      max-width:1200px;
      display:grid;
      grid-template-columns: 1fr 1.1fr;
      align-items:center;
      gap:22px;
    }
    .heartLeft{
      display:flex;
      flex-direction:column;
      gap:12px;
      padding-left:10px;
    }
    .heartLeft .big{
      font-size:52px;
      font-weight:900;
      color: var(--accent);
      line-height:1.05;
    }
    .heartLeft .small{
      font-size:22px;
      font-weight:600;
      color:#5b5555;
    }
    .heartBtnBox{
      display:flex;
      align-items:center;
      justify-content:flex-start;
      gap:18px;
      padding-top:6px;
    }
    .heartBtn{
      width:110px; height:110px;
      display:grid;
      place-items:center;
      cursor:pointer;
      user-select:none;
      background: transparent;
      border:0;
      padding:0;
    }
    .heartSvg{
      width:92px; height:92px;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.18));
      transform: translateZ(0);
    }
    .tapHint{
      font-size:18px;
      color:#6b6565;
      font-weight:600;
    }

    /* ====== ESCENA √ÅRBOL + TEXTO ====== */
    #screenTree{
      background: var(--bg);
    }
    .treeLayout{
      position:absolute; inset:0;
      display:grid;
      grid-template-columns: 1.05fr 1fr;
      gap:10px;
      padding:30px 34px;
      box-sizing:border-box;
      align-items:center;
    }
    .msg{
      color: var(--text);
      font-size:20px;           /* m√°s peque√±a para que entre completa */
      line-height:1.35;
      font-weight:600;          /* un poco m√°s fina que ‚Äúnegrita pesada‚Äù */
      max-width:640px;
    }
    .msg .line{opacity:0;}
    .treeBox{
      position:relative;
      width:100%;
      height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    canvas{width:100%; height:100%;}

    /* responsive dentro del ‚Äúhorizontal forzado‚Äù */
    @media (max-width: 820px){
      .introTxt h1{font-size:34px;}
      .introTxt p{font-size:18px;}
      .heartLeft .big{font-size:44px;}
      .msg{font-size:18px;}
    }
  </style>
</head>
<body>

  <div id="stage">
    <!-- INTRO -->
    <section id="screenIntro" class="screen show">
      <div class="introWrap">
        <div class="phoneIcon" aria-hidden="true"></div>
        <div class="introTxt">
          <h1>–ü–û–ñ–ê–õ–£–ô–°–¢–ê, –ü–û–í–ï–†–ù–ò –¢–ï–õ–ï–§–û–ù</h1>
          <p>–°–µ–π—á–∞—Å –Ω–∞—á–Ω—ë—Ç—Å—è —Å—é—Ä–ø—Ä–∏–∑ ‚ú®</p>
        </div>
      </div>
    </section>

    <!-- CORAZ√ìN -->
    <section id="screenHeart" class="screen">
      <div class="heartWrap">
        <div class="heartLeft">
          <div class="big">–° –î–Ω—ë–º —Å–≤—è—Ç–æ–≥–æ<br/>–í–∞–ª–µ–Ω—Ç–∏–Ω–∞!</div>
          <div class="small">–ù–∞–∂–º–∏ –Ω–∞ —Å–µ—Ä–¥–µ—á–∫–æ üíû</div>
          <div class="heartBtnBox">
            <button class="heartBtn" id="startBtn" aria-label="start">
              <!-- coraz√≥n ‚Äúbonito‚Äù (no deforme) -->
              <svg class="heartSvg" viewBox="0 0 64 64" role="img" aria-hidden="true">
                <path fill="#d61f3a" d="M32 57s-21-13.7-27.5-26.2C-1.1 18.3 7.2 7 20.2 11.2c5.4 1.7 8.2 6 11.8 10 3.6-4 6.4-8.3 11.8-10C56.8 7 65.1 18.3 59.5 30.8 53 43.3 32 57 32 57z"/>
                <path fill="rgba(255,255,255,.35)" d="M22 16c-4.6-1.4-9.5 1.5-11 6.4-.3 1-.4 2-.3 3 .8-3.6 3.1-6.6 6.9-7.6 1.6-.5 3.2-.5 4.7.2z"/>
              </svg>
            </button>
            <div class="tapHint">–ù–∞–∂–º–∏ ‚ù§Ô∏è</div>
          </div>
        </div>
        <div></div>
      </div>
    </section>

    <!-- √ÅRBOL -->
    <section id="screenTree" class="screen">
      <div class="treeLayout">
        <div class="msg" id="msg"></div>
        <div class="treeBox">
          <canvas id="c"></canvas>
        </div>
      </div>
    </section>
  </div>

<script>
/* ====== FORZAR HORIZONTAL SIEMPRE ====== */
const stage = document.getElementById('stage');
function fitLandscape(){
  const w = window.innerWidth;
  const h = window.innerHeight;

  // Queremos ‚Äúcontenido horizontal‚Äù (landscape) ocupando la pantalla vertical/horizontal.
  // Creamos un rect√°ngulo landscape (base: ancho = h, alto = w) y lo rotamos si hace falta.
  // Si est√° en portrait (h>w), rotamos el stage 90deg para que se vea horizontal dentro.
  const isPortrait = h > w;

  if(isPortrait){
    // rotar 90¬∞ y escalar para encajar
    stage.style.transform = `rotate(90deg) translateY(-100%)`;
    stage.style.width = h + "px";
    stage.style.height = w + "px";
    stage.style.left = (w - h)/2 + "px";
    stage.style.top  = (h - w)/2 + "px";
    stage.style.position = "fixed";
  }else{
    stage.style.transform = "none";
    stage.style.width = "100%";
    stage.style.height = "100%";
    stage.style.left = "0";
    stage.style.top = "0";
    stage.style.position = "fixed";
  }

  resizeCanvas();
}
window.addEventListener('resize', fitLandscape);

/* ====== PANTALLAS ====== */
const intro = document.getElementById('screenIntro');
const heart = document.getElementById('screenHeart');
const tree  = document.getElementById('screenTree');

function show(el){
  [intro,heart,tree].forEach(s=>s.classList.remove('show'));
  el.classList.add('show');
}

/* intro 4 segundos */
setTimeout(()=>{
  show(heart);
}, 4000);

/* ====== TEXTO (izquierda) ====== */
const msgEl = document.getElementById('msg');
const fullText = [
  "–ò–Ω–æ–≥–¥–∞ –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –º–∏—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–µ–ø–ª–µ–µ, –∫–æ–≥–¥–∞ —è –¥—É–º–∞—é –æ —Ç–µ–±–µ.",
  "–¢—ã —É–º–µ–µ—à—å –¥–µ–ª–∞—Ç—å –æ–±—ã—á–Ω—ã–π –¥–µ–Ω—å –æ—Å–æ–±–µ–Ω–Ω—ã–º ‚Äî –ø—Ä–æ—Å—Ç–æ —Å–≤–æ–∏–º –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ–º.",
  "–ú–Ω–µ —Ö–æ—á–µ—Ç—Å—è –±–µ—Ä–µ—á—å —Ç–µ–±—è, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ —Ä–∞–¥–æ–≤–∞—Ç—å, –¥–∞–∂–µ –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏.",
  "–Ø —Ü–µ–Ω—é –∫–∞–∂–¥—É—é –Ω–∞—à—É –º–∏–Ω—É—Ç—É, –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –∏ –∫–∞–∂–¥—É—é —É–ª—ã–±–∫—É.",
  "–Ø –æ—á–µ–Ω—å —Å–∫—É—á–∞—é‚Ä¶ –∏ –ø—Ä–∞–≤–¥–∞, –æ—á–µ–Ω—å —Ç–µ–±—è –ª—é–±–ª—é."
];

/* escribir palabra por palabra */
let typingTimer = null;
function typeWordByWord(lines){
  msgEl.innerHTML = "";
  const spans = [];
  lines.forEach(line=>{
    const p = document.createElement('div');
    p.style.marginBottom = "10px";
    const s = document.createElement('span');
    s.className="line";
    s.textContent = line;
    p.appendChild(s);
    msgEl.appendChild(p);
    spans.push(s);
  });

  let iLine=0, iWord=0;
  const words = spans.map(s=>s.textContent.split(" "));
  spans.forEach(s=>s.textContent="");

  function step(){
    if(iLine>=spans.length) return;
    spans[iLine].style.opacity = 1;
    const w = words[iLine];
    spans[iLine].textContent += (iWord===0 ? "" : " ") + w[iWord];
    iWord++;
    if(iWord>=w.length){ iLine++; iWord=0; }
    typingTimer = setTimeout(step, 90);
  }
  step();
}

/* ====== CANVAS √ÅRBOL (derecha) ====== */
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');

let W=0,H=0,dpr=1;

/* ‚Äúm√°s hojas‚Äù + forma coraz√≥n */
const LEAF_COUNT = 1200;     // M√ÅS hojas
const FALL_COUNT = 200;      // viento (corazones que vuelan)
const HEART_FILL = 0.96;     // 95-96% densidad (t√∫ pediste 95%)
const TRUNK_HIDE = true;     // tapar tronco (menos la base)

let leaves = [];
let falling = [];
let startAnimAt = 0;
let running = false;

function resizeCanvas(){
  const rect = canvas.getBoundingClientRect();
  dpr = Math.max(1, window.devicePixelRatio || 1);
  canvas.width  = Math.floor(rect.width * dpr);
  canvas.height = Math.floor(rect.height * dpr);
  W = canvas.width;
  H = canvas.height;
  ctx.setTransform(1,0,0,1,0,0);
  ctx.scale(1,1);

  buildLeaves();
}

function rnd(a,b){ return a + Math.random()*(b-a); }

function heartPoint(t){
  // f√≥rmula cl√°sica coraz√≥n
  const x = 16*Math.pow(Math.sin(t),3);
  const y = 13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t);
  return {x, y};
}

function buildLeaves(){
  leaves = [];
  falling = [];

  // √Årea donde ir√° el coraz√≥n (derecha)
  const cx = W*0.55;              // centro coraz√≥n
  const cy = H*0.35;
  const scale = Math.min(W,H) * 0.020;

  // Generar puntos dentro del coraz√≥n (relleno)
  for(let i=0;i<LEAF_COUNT;i++){
    const t = rnd(0, Math.PI*2);
    const p = heartPoint(t);

    // ‚Äúrelleno‚Äù hacia adentro (mejor forma)
    const k = Math.pow(Math.random(), 0.55) * HEART_FILL; // m√°s denso al borde
    const x = cx + p.x*scale*k + rnd(-8,8)*dpr;
    const y = cy - p.y*scale*k + rnd(-6,10)*dpr;

    // color random entre rosas/rojos como referencia
    const palette = [
      "rgba(255,  0, 80, .70)",
      "rgba(255, 40, 90, .68)",
      "rgba(255,110,140,.60)",
      "rgba(255, 70, 60, .65)",
      "rgba(255,150,170,.55)"
    ];
    const col = palette[(Math.random()*palette.length)|0];

    leaves.push({
      x,y,
      r: rnd(5,10)*dpr,
      a: rnd(0, Math.PI*2),
      col
    });
  }

  // corazones que ‚Äúviento‚Äù se lleva
  for(let i=0;i<FALL_COUNT;i++){
    falling.push({
      x: rnd(W*0.25, W*0.95),
      y: rnd(-H*0.1, H*1.1),
      vx: rnd(-0.6, 1.2)*dpr,
      vy: rnd(0.6, 1.6)*dpr,
      r: rnd(4,9)*dpr,
      col: "rgba(255,90,130,.55)",
      rot: rnd(0,Math.PI*2),
      vr: rnd(-0.03,0.03)
    });
  }
}

function drawHeartLeaf(x,y,r,rot,color){
  ctx.save();
  ctx.translate(x,y);
  ctx.rotate(rot);
  ctx.fillStyle = color;
  ctx.beginPath();
  // mini coraz√≥n
  const s = r/10;
  ctx.moveTo(0, 3*s);
  ctx.bezierCurveTo(0, 0, -6*s, 0, -6*s, 3*s);
  ctx.bezierCurveTo(-6*s, 6*s, -2*s, 9*s, 0, 12*s);
  ctx.bezierCurveTo(2*s, 9*s, 6*s, 6*s, 6*s, 3*s);
  ctx.bezierCurveTo(6*s, 0, 0, 0, 0, 3*s);
  ctx.closePath();
  ctx.fill();
  ctx.restore();
}

function drawTreeBase(){
  // base visible (abajo), m√°s ancha
  const baseX = W*0.55;
  const baseY = H*0.86;

  ctx.lineCap = "round";
  ctx.strokeStyle = "rgba(35,30,30,.95)";

  // ‚Äúpie‚Äù m√°s ancho
  ctx.lineWidth = 18*dpr;
  ctx.beginPath();
  ctx.moveTo(baseX-40*dpr, baseY);
  ctx.quadraticCurveTo(baseX, baseY+18*dpr, baseX+40*dpr, baseY);
  ctx.stroke();

  // tronco (tapado arriba por hojas)
  ctx.lineWidth = 34*dpr;
  ctx.beginPath();
  ctx.moveTo(baseX, baseY);
  ctx.lineTo(baseX, H*0.45);
  ctx.stroke();

  // ramas (se ver√°n MUY poco porque las hojas las cubren)
  ctx.lineWidth = 14*dpr;
  ctx.beginPath();
  ctx.moveTo(baseX, H*0.52);
  ctx.lineTo(baseX-90*dpr, H*0.43);
  ctx.moveTo(baseX, H*0.52);
  ctx.lineTo(baseX+90*dpr, H*0.43);
  ctx.stroke();
}

function maskTrunk(){
  // m√°scara para ocultar tronco arriba, dejando base visible
  ctx.save();
  ctx.globalCompositeOperation = "destination-out";
  ctx.fillStyle = "rgba(0,0,0,1)";
  // tapar desde un poco arriba del pie hacia arriba
  ctx.fillRect(0, 0, W, H*0.80);
  ctx.restore();
}

function tick(ts){
  if(!running) return;
  const t = (ts - startAnimAt)/1000;

  ctx.clearRect(0,0,W,H);

  // fondo
  ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--bg');
  ctx.fillRect(0,0,W,H);

  // √°rbol (primero)
  drawTreeBase();

  // hojas (muchas) encima para cubrir ramas/tronco
  for(const lf of leaves){
    // peque√±o ‚Äúviento‚Äù para que vibren
    const sway = Math.sin(t*1.8 + lf.x*0.002) * 1.5*dpr;
    drawHeartLeaf(lf.x + sway, lf.y, lf.r, lf.a + Math.sin(t)*0.02, lf.col);
  }

  // ocultar tronco/ramas (excepto base)
  if(TRUNK_HIDE){
    // En vez de m√°scara total (que borrar√≠a hojas), hacemos ‚Äúre-dibujar‚Äù hojas extra encima de la zona del tronco
    // para que pr√°cticamente no se vea: ya se logra por densidad, pero reforzamos en el centro.
    ctx.save();
    ctx.globalAlpha = 0.9;
    for(let k=0;k<260;k++){
      const x = W*0.55 + rnd(-40,40)*dpr;
      const y = rnd(H*0.48, H*0.84);
      drawHeartLeaf(x, y, rnd(6,10)*dpr, rnd(0,Math.PI*2), "rgba(255,80,120,.60)");
    }
    ctx.restore();
  }

  // corazones volando (viento)
  for(const f of falling){
    f.x += f.vx;
    f.y += f.vy;
    f.rot += f.vr;
    // ‚Äúbrisa‚Äù lateral
    f.x += Math.sin(t*1.2 + f.y*0.01)*0.6*dpr;

    // wrap
    if(f.y > H+30*dpr){ f.y = -30*dpr; f.x = rnd(W*0.30, W*0.98); }
    if(f.x < -40*dpr) f.x = W+40*dpr;
    if(f.x > W+40*dpr) f.x = -40*dpr;

    drawHeartLeaf(f.x, f.y, f.r, f.rot, f.col);
  }

  requestAnimationFrame(tick);
}

function startTreeScene(){
  show(tree);
  // texto palabra por palabra un poco despu√©s de que el √°rbol ‚Äúaparece‚Äù
  setTimeout(()=> typeWordByWord(fullText), 900);

  running = true;
  startAnimAt = performance.now();
  requestAnimationFrame(tick);
}

/* click coraz√≥n -> √°rbol */
document.getElementById('startBtn').addEventListener('click', ()=>{
  startTreeScene();
});

/* init */
fitLandscape();
</script>
</body>
</html>