<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>üíó</title>
  <style>
    :root{
      --bg: #efe0d8;
      --ink: #3b2b2b;
      --muted: rgba(59,43,43,.72);
      --heart: #d91f2a;
      --panelW: min(44vw, 520px);
      --safeL: max(16px, env(safe-area-inset-left));
      --safeR: max(16px, env(safe-area-inset-right));
      --safeT: max(14px, env(safe-area-inset-top));
      --safeB: max(14px, env(safe-area-inset-bottom));
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; background:#000; overflow:hidden}

    /* Gate vertical */
    #rotateGate{
      position:fixed; inset:0;
      display:flex; align-items:center; justify-content:center;
      background:#000; color:#fff;
      z-index:9999;
      padding:24px;
    }
    .rotateBox{display:flex; gap:18px; align-items:center; user-select:none}
    .phoneIcon{
      width:54px; height:92px; border:3px solid #fff; border-radius:10px;
      position:relative; opacity:.92;
    }
    .phoneIcon:after{
      content:""; position:absolute; left:50%; bottom:8px;
      width:10px; height:10px; border:2px solid #fff; border-radius:50%;
      transform:translateX(-50%); opacity:.85;
    }
    .rotateText{line-height:1.1; font-weight:800; font-size:22px; letter-spacing:.3px}
    .hint{opacity:.65; font-weight:700; margin-top:10px; font-size:13px}

    /* App */
    #app{
      position:fixed; inset:0;
      background:var(--bg);
      color:var(--ink);
      display:none;
    }

    /* Screen Heart */
    #screenHeart{
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      background:var(--bg);
    }
    .heartWrap{text-align:center; transform: translateY(-8px)}
    .heartBtn{
      width:min(140px, 26vw);
      aspect-ratio: 1 / 1;
      border:0; background:transparent;
      cursor:pointer;
      display:inline-grid;
      place-items:center;
      outline:none;
      user-select:none;
      filter: drop-shadow(0 16px 20px rgba(0,0,0,.12));
    }
    .heartBtn:active{transform:scale(.98)}
    .heartLabel{
      margin-top:12px;
      font-size:18px;
      font-weight:800;
      color:var(--muted);
    }

    /* Screen Tree */
    #screenTree{
      position:absolute; inset:0;
      display:none;
      background:var(--bg);
    }
    #canvas{position:absolute; inset:0; width:100%; height:100%; display:block}

    #sideText{
      position:absolute;
      left: var(--safeL);
      top: var(--safeT);
      width: var(--panelW);
      max-height: 78vh;
      overflow:hidden;
      padding:14px 14px 12px 14px;
      background: rgba(255,255,255,.35);
      border-radius:14px;
      backdrop-filter: blur(6px);
      box-shadow: 0 10px 30px rgba(0,0,0,.08);
    }
    #sideText h3{margin:0 0 8px 0; font-size:18px}
    #typeArea{font-size:16px; line-height:1.38; color:var(--ink)}
    #cursor{
      display:inline-block; width:10px; margin-left:2px; opacity:.9;
      animation: blink 1s step-end infinite;
    }
    @keyframes blink { 50%{opacity:0} }

    #counterBar{
      position:absolute;
      left: var(--safeL);
      right: var(--safeR);
      bottom: var(--safeB);
      padding:12px 14px;
      background: rgba(255,255,255,.35);
      border-radius:14px;
      backdrop-filter: blur(6px);
      box-shadow: 0 10px 30px rgba(0,0,0,.08);
      display:flex;
      gap:10px;
      align-items:baseline;
      flex-wrap:wrap;
    }
    #counterTitle{font-weight:900; color:var(--muted)}
    #counter{font-weight:900; letter-spacing:.2px}

    #skipHint{
      position:absolute;
      right: var(--safeR);
      top: var(--safeT);
      font-size:13px;
      color:rgba(59,43,43,.55);
      font-weight:800;
      user-select:none;
    }

    @media (max-height: 420px){
      #sideText{max-height:70vh; width:min(52vw, 520px)}
      #typeArea{font-size:14px}
      .rotateText{font-size:18px}
    }
  </style>
</head>
<body>

  <div id="rotateGate">
    <div class="rotateBox">
      <div class="phoneIcon" aria-hidden="true"></div>
      <div>
        <div class="rotateText" id="rotateTextUI">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–≤–µ—Ä–Ω–∏ —Ç–µ–ª–µ—Ñ–æ–Ω</div>
        <div class="hint" id="rotateHintUI">–û—Ç–∫—Ä–æ–π –≤ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ</div>
      </div>
    </div>
  </div>

  <div id="app">
    <section id="screenHeart" aria-label="start">
      <div class="heartWrap">
        <button class="heartBtn" id="startBtn" aria-label="–ù–∞–∂–º–∏ –Ω–∞ —Å–µ—Ä–¥–µ—á–∫–æ">
          <svg viewBox="0 0 64 64" width="100%" height="100%" aria-hidden="true">
            <path fill="var(--heart)" d="M32 56s-2.6-1.9-5.8-4.4C17.2 44.8 8 37.6 8 27.6 8 20.1 13.8 14 21.2 14c4.1 0 8 2 10.4 5.2C34 16 37.9 14 42 14 49.4 14 55 20.1 55 27.6c0 10-9.2 17.2-18.2 24C34.6 54.1 32 56 32 56z"/>
            <path fill="rgba(255,255,255,.35)" d="M22 20c-4.2 1.3-6.6 6-4.9 10.7.4 1.1-.9 2-1.7 1.1-3.4-4.2-2.5-11 2.4-14.5 1.3-.9 3-.3 4.2 0z"/>
          </svg>
        </button>
        <div class="heartLabel" id="heartLabelUI">–ù–∞–∂–º–∏ –Ω–∞ —Å–µ—Ä–¥–µ—á–∫–æ</div>
      </div>
    </section>

    <section id="screenTree" aria-label="tree">
      <canvas id="canvas"></canvas>

      <div id="skipHint">–ö–æ—Å–Ω–∏—Å—å —Ç–µ–∫—Å—Ç–∞, —á—Ç–æ–±—ã –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å ‚ú®</div>

      <aside id="sideText">
        <h3 id="sideTitleUI">–î–ª—è —Ç–µ–±—è, –º–æ—è –æ—Å–æ–±–µ–Ω–Ω–∞—è:</h3>
        <div id="typeArea"></div><span id="cursor">|</span>
      </aside>

      <footer id="counterBar">
        <div id="counterTitleUI">–° —Ç–µ—Ö –ø–æ—Ä, –∫–∞–∫ –º—ã –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å, –ø—Ä–æ—à–ª–æ:</div>
        <div id="counter">‚Äî</div>
      </footer>
    </section>
  </div>

<script>
/* =========================
   CONFIG (EDITA AQU√ç)
   ========================= */
const CONFIG = {
  // Fecha inicio para contador (YYYY-MM-DDTHH:mm:ss)
  startDateISO: "2025-02-14T00:00:00",

  rotateText: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–≤–µ—Ä–Ω–∏ —Ç–µ–ª–µ—Ñ–æ–Ω",
  rotateHint: "–û—Ç–∫—Ä–æ–π –≤ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ",
  heartLabel: "–ù–∞–∂–º–∏ –Ω–∞ —Å–µ—Ä–¥–µ—á–∫–æ",
  sideTitle: "–î–ª—è —Ç–µ–±—è, –º–æ—è –æ—Å–æ–±–µ–Ω–Ω–∞—è:",
  counterTitle: "–° —Ç–µ—Ö –ø–æ—Ä, –∫–∞–∫ –º—ã –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å, –ø—Ä–æ—à–ª–æ:",

  // Mensaje lateral (palabra por palabra). Cada string es una l√≠nea.
  messageLines: [
    "–ò–Ω–æ–≥–¥–∞ –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –≤—Å—ë –≤–æ–∫—Ä—É–≥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ª—É—á—à–µ, –∫–æ–≥–¥–∞ —è –¥—É–º–∞—é –æ —Ç–µ–±–µ.",
    "–¢—ã –ø–æ—è–≤–∏–ª–∞—Å—å –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏ —Ç–∞–∫ —Ç–∏—Ö–æ, –Ω–æ –æ—Å—Ç–∞–≤–∏–ª–∞ –≤ –Ω–µ–π —Å—Ç–æ–ª—å–∫–æ —Ç–µ–ø–ª–∞.",
    "–ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —É–∑–Ω–∞–≤–∞—Ç—å —Ç–µ–±—è ‚Äî —Ç–≤–æ–∏ –º—ã—Å–ª–∏, —Ç–≤–æ–∏ –º–µ—á—Ç—ã, —Ç–≤–æ—é —É–ª—ã–±–∫—É.",
    "–Ø –Ω–µ –æ–±–µ—â–∞—é –∏–¥–µ–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤, –Ω–æ –æ–±–µ—â–∞—é –∏—Å–∫—Ä–µ–Ω–Ω–æ—Å—Ç—å:",
    "—è —Ö–æ—á—É –±—ã—Ç—å —Ä—è–¥–æ–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ç–µ–±—è –∏ –¥–µ–ª–∞—Ç—å —Ç–≤–æ–∏ –¥–Ω–∏ —á—É—Ç—å —Å–≤–µ—Ç–ª–µ–µ.",
    "–ï—Å–ª–∏ –æ–¥–Ω–∞–∂–¥—ã —Ç–µ–±–µ —Å—Ç–∞–Ω–µ—Ç –≥—Ä—É—Å—Ç–Ω–æ –∏–ª–∏ —Ç—è–∂–µ–ª–æ ‚Äî –ø—Ä–æ—Å—Ç–æ –≤—Å–ø–æ–º–Ω–∏:",
    "–≥–¥–µ-—Ç–æ –µ—Å—Ç—å —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –æ—á–µ–Ω—å —Ü–µ–Ω–∏—Ç —Ç–µ–±—è.",
    "–Ø —Ç–µ–±—è –ª—é–±–ª—é. üíó"
  ],

  // Velocidad del texto (ms por palabra)
  wordDelayMs: 150
};

/* =========================
   UI + ORIENTATION
   ========================= */
const rotateGate = document.getElementById("rotateGate");
const app = document.getElementById("app");
const screenHeart = document.getElementById("screenHeart");
const screenTree = document.getElementById("screenTree");
const startBtn = document.getElementById("startBtn");

document.getElementById("rotateTextUI").textContent = CONFIG.rotateText;
document.getElementById("rotateHintUI").textContent = CONFIG.rotateHint;
document.getElementById("heartLabelUI").textContent = CONFIG.heartLabel;
document.getElementById("sideTitleUI").textContent = CONFIG.sideTitle;
document.getElementById("counterTitleUI").textContent = CONFIG.counterTitle;

function isLandscape(){
  return window.matchMedia("(orientation: landscape)").matches;
}
function updateOrientationUI(){
  const land = isLandscape();
  rotateGate.style.display = land ? "none" : "flex";
  app.style.display = land ? "block" : "none";
}
window.addEventListener("orientationchange", updateOrientationUI);
window.addEventListener("resize", updateOrientationUI);
updateOrientationUI();

/* =========================
   COUNTER
   ========================= */
const counterEl = document.getElementById("counter");
const startDate = new Date(CONFIG.startDateISO);

function pad2(n){ return String(n).padStart(2,"0"); }
function updateCounter(){
  const now = new Date();
  let diff = Math.max(0, now - startDate);
  const sec = Math.floor(diff/1000);
  const days = Math.floor(sec / 86400);
  const hours = Math.floor((sec % 86400)/3600);
  const mins = Math.floor((sec % 3600)/60);
  const secs = sec % 60;
  counterEl.textContent = `${days} –¥–Ω. ${pad2(hours)} —á. ${pad2(mins)} –º–∏–Ω. ${pad2(secs)} —Å–µ–∫.`;
}
setInterval(updateCounter, 250);
updateCounter();

/* =========================
   TYPEWRITER (word-by-word)
   ========================= */
const typeArea = document.getElementById("typeArea");
const cursor = document.getElementById("cursor");
const sideText = document.getElementById("sideText");

let typeTokens = [];
let typeIndex = 0;
let typing = false;
let typingTimer = null;

function buildTokens(lines){
  const tokens = [];
  lines.forEach((line, li) => {
    // split por espacios (mantiene puntuaci√≥n pegada)
    const words = line.trim().split(/\s+/).filter(Boolean);
    words.forEach(w => tokens.push({t:"w", v:w}));
    if(li !== lines.length-1) tokens.push({t:"br"});
  });
  return tokens;
}

function renderTokensUpTo(n){
  let html = "";
  for(let i=0;i<n;i++){
    const tok = typeTokens[i];
    if(tok.t === "br") html += "<br>";
    else html += (html.endsWith(">") || html==="" ? "" : " ") + escapeHtml(tok.v);
  }
  typeArea.innerHTML = html;
}

function escapeHtml(s){
  return s.replace(/[&<>"']/g, m => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
  }[m]));
}

function startTyping(){
  typeTokens = buildTokens(CONFIG.messageLines);
  typeIndex = 0;
  typing = true;
  cursor.style.display = "inline-block";
  typeArea.innerHTML = "";
  if(typingTimer) clearTimeout(typingTimer);

  const step = () => {
    if(!typing) return;
    typeIndex++;
    renderTokensUpTo(typeIndex);

    if(typeIndex >= typeTokens.length){
      typing = false;
      cursor.style.display = "none";
      return;
    }
    typingTimer = setTimeout(step, CONFIG.wordDelayMs);
  };
  step();
}

function skipTyping(){
  if(!typing) return;
  typing = false;
  if(typingTimer) clearTimeout(typingTimer);
  renderTokensUpTo(typeTokens.length);
  cursor.style.display = "none";
}
sideText.addEventListener("click", skipTyping);
sideText.addEventListener("touchstart", (e)=>{ e.preventDefault(); skipTyping(); }, {passive:false});

/* =========================
   CANVAS TREE ANIMATION
   ========================= */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
let W=0, H=0, DPR=1;

function resizeCanvas(){
  DPR = Math.max(1, Math.min(3, window.devicePixelRatio || 1));
  W = Math.floor(canvas.clientWidth);
  H = Math.floor(canvas.clientHeight);
  canvas.width = Math.floor(W * DPR);
  canvas.height = Math.floor(H * DPR);
  ctx.setTransform(DPR,0,0,DPR,0,0);
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

/* √Årbol: segmentos (tronco + ramas) */
function lerp(a,b,t){ return a+(b-a)*t; }

function makeSegments(){
  const baseX = W*0.70;
  const groundY = H*0.90;
  const topY = H*0.28;

  // puntos principales
  const trunkTop = {x: baseX, y: lerp(groundY, topY, 0.55)};
  const trunkBase = {x: baseX, y: groundY};

  // ramas (forma coraz√≥n)
  const left1 = {x: baseX - W*0.10, y: lerp(groundY, topY, 0.46)};
  const left2 = {x: baseX - W*0.16, y: lerp(groundY, topY, 0.35)};
  const left3 = {x: baseX - W*0.08, y: lerp(groundY, topY, 0.26)};

  const right1 = {x: baseX + W*0.10, y: lerp(groundY, topY, 0.46)};
  const right2 = {x: baseX + W*0.16, y: lerp(groundY, topY, 0.35)};
  const right3 = {x: baseX + W*0.08, y: lerp(groundY, topY, 0.26)};

  // segmentos como curvas simples (start -> ctrl -> end)
  return [
    {a:trunkBase, c:{x:baseX, y:lerp(trunkBase.y,trunkTop.y,0.6)}, b:trunkTop, w:18},
    {a:trunkTop, c:{x:lerp(trunkTop.x,left1.x,0.3), y:lerp(trunkTop.y,left1.y,0.5)}, b:left1, w:12},
    {a:left1, c:{x:lerp(left1.x,left2.x,0.5), y:lerp(left1.y,left2.y,0.4)}, b:left2, w:9},
    {a:left2, c:{x:lerp(left2.x,left3.x,0.7), y:lerp(left2.y,left3.y,0.4)}, b:left3, w:7},

    {a:trunkTop, c:{x:lerp(trunkTop.x,right1.x,0.7), y:lerp(trunkTop.y,right1.y,0.5)}, b:right1, w:12},
    {a:right1, c:{x:lerp(right1.x,right2.x,0.5), y:lerp(right1.y,right2.y,0.4)}, b:right2, w:9},
    {a:right2, c:{x:lerp(right2.x,right3.x,0.3), y:lerp(right2.y,right3.y,0.4)}, b:right3, w:7},

    // ramitas extra
    {a:left1, c:{x:left1.x-W*0.06, y:left1.y-H*0.05}, b:{x:left1.x-W*0.10, y:left1.y-H*0.12}, w:6},
    {a:right1, c:{x:right1.x+W*0.06, y:right1.y-H*0.05}, b:{x:right1.x+W*0.10, y:right1.y-H*0.12}, w:6},
  ];
}

let segments = makeSegments();
let t0 = 0;
let running = false;

// corazones part√≠culas
const petals = [];
function rand(a,b){ return a + Math.random()*(b-a); }

function spawnPetal(x,y){
  petals.push({
    x, y,
    vx: rand(-20, 20),
    vy: rand(-10, 25),
    rot: rand(0, Math.PI*2),
    vr: rand(-2.5, 2.5),
    s: rand(6, 12),
    life: rand(4, 8),
    age: 0,
    color: Math.random() < 0.5 ? "rgba(217,31,42,.95)" : "rgba(255,120,155,.9)"
  });
}

function drawHeart(x,y,size,rot,color){
  ctx.save();
  ctx.translate(x,y);
  ctx.rotate(rot);
  ctx.scale(size/16, size/16);
  ctx.beginPath();
  ctx.moveTo(0, -4);
  ctx.bezierCurveTo(6, -10, 16, -4, 0, 12);
  ctx.bezierCurveTo(-16, -4, -6, -10, 0, -4);
  ctx.closePath();
  ctx.fillStyle = color;
  ctx.fill();
  ctx.restore();
}

function drawGround(){
  ctx.save();
  ctx.fillStyle = "rgba(59,43,43,.12)";
  ctx.fillRect(0, H*0.88, W, H*0.12);
  ctx.restore();
}

function drawSegment(seg, p){
  // p 0..1, dibuja parte de curva cuadr√°tica aproximando por pasos
  const steps = 24;
  const n = Math.max(2, Math.floor(steps * p));
  ctx.beginPath();
  for(let i=0;i<n;i++){
    const tt = i/(steps-1);
    if(tt>p) break;
    const x = quad(seg.a.x, seg.c.x, seg.b.x, tt);
    const y = quad(seg.a.y, seg.c.y, seg.b.y, tt);
    if(i===0) ctx.moveTo(x,y);
    else ctx.lineTo(x,y);
  }
  ctx.strokeStyle = "#3b2b2b";
  ctx.lineWidth = seg.w;
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
  ctx.stroke();
}

function quad(a,c,b,t){
  // (1-t)^2 a + 2(1-t)t c + t^2 b
  const mt = 1-t;
  return mt*mt*a + 2*mt*t*c + t*t*b;
}

// puntos ‚Äúhojas‚Äù a lo largo de ramas
const leafPoints = [];
function buildLeafPoints(){
  leafPoints.length = 0;
  segments.forEach(seg=>{
    const steps=18;
    for(let i=6;i<steps;i++){
      const t=i/(steps-1);
      const x=quad(seg.a.x,seg.c.x,seg.b.x,t);
      const y=quad(seg.a.y,seg.c.y,seg.b.y,t);
      // solo en zona alta para que parezca copa
      if(y < H*0.62) leafPoints.push({x,y});
    }
  });
}

function tick(now){
  if(!running) return;
  const dt = Math.min(0.033, (now - t0) / 1000);
  t0 = now;

  ctx.clearRect(0,0,W,H);

  // fondo suave
  ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue("--bg").trim() || "#efe0d8";
  ctx.fillRect(0,0,W,H);

  drawGround();

  // Timeline:
  // 0..2.5s crece tronco y ramas
  // 2.5..4s aparecen corazones en copa
  // luego: viento y p√©talos volando
  const elapsed = (now - startAnimAt) / 1000;

  // crecimiento
  const growT = Math.min(1, elapsed / 2.6);
  const perSeg = 1 / segments.length;

  for(let i=0;i<segments.length;i++){
    const segT = clamp((growT - i*perSeg) / perSeg, 0, 1);
    if(segT>0) drawSegment(segments[i], segT);
  }

  // corazones ‚Äúcopa‚Äù
  if(elapsed > 2.2){
    const appear = clamp((elapsed - 2.2)/1.6, 0, 1);
    // dibuja corazones fijos como p√©talos
    const count = Math.floor(leafPoints.length * appear);
    for(let i=0;i<count;i++){
      const p = leafPoints[i];
      const s = 8 + (i%5);
      drawHeart(p.x + rand(-1,1), p.y + rand(-1,1), s, rand(-0.3,0.3), (i%3===0) ? "rgba(217,31,42,.95)" : "rgba(255,120,155,.9)");
    }

    // desprender algunos con viento
    if(elapsed > 3.4 && petals.length < 80 && Math.random() < 0.18){
      const pick = leafPoints[Math.floor(Math.random()*leafPoints.length)];
      spawnPetal(pick.x, pick.y);
    }
  }

  // part√≠culas volando
  const wind = Math.sin(now/1200) * 18; // viento lateral
  for(let i=petals.length-1;i>=0;i--){
    const p = petals[i];
    p.age += dt;
    p.vx += (wind*0.15) * dt;
    p.vy += 25*dt; // gravedad suave
    p.x += p.vx*dt;
    p.y += p.vy*dt;
    p.rot += p.vr*dt;

    // dibujar
    const alpha = clamp(1 - (p.age/p.life), 0, 1);
    drawHeart(p.x, p.y, p.s, p.rot, p.color.replace(/[\d.]+\)$/,(alpha*0.95)+")"));

    if(p.age > p.life || p.y > H+40 || p.x < -60 || p.x > W+60){
      petals.splice(i,1);
    }
  }

  requestAnimationFrame(tick);
}

function clamp(v,a,b){ return Math.max(a, Math.min(b,v)); }

/* =========================
   START FLOW
   ========================= */
let startAnimAt = 0;

function startTreeScene(){
  screenHeart.style.display = "none";
  screenTree.style.display = "block";

  resizeCanvas();
  segments = makeSegments();
  buildLeafPoints();

  // iniciar animaci√≥n
  running = true;
  startAnimAt = performance.now();
  t0 = startAnimAt;
  petals.length = 0;
  requestAnimationFrame(tick);

  // texto: empieza cuando la copa ya est√° saliendo
  setTimeout(()=> startTyping(), 2400);
}

startBtn.addEventListener("click", ()=>{
  if(!isLandscape()) return; // si est√° vertical, nada
  startTreeScene();
});

/* si gira mientras est√° en pantalla √°rbol, recalcular */
window.addEventListener("resize", ()=>{
  if(screenTree.style.display === "block"){
    resizeCanvas();
    segments = makeSegments();
    buildLeafPoints();
  }
});
</script>
</body>
</html>
